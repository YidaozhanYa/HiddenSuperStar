VERSION 5.00
Object = "{7020C36F-09FC-41FE-B822-CDE6FBB321EB}#1.2#0"; "VBCCR17.OCX"
Object = "{A2A736C2-8DAC-4CDB-B1CB-3B077FBB14F9}#6.2#0"; "VB6Resizer2.ocx"
Begin VB.Form frmBrowse 
   BackColor       =   &H80000005&
   Caption         =   "Òþ²ØµÄÎÞµÐÐÇ - ä¯ÀÀÔÚÏß¹Ø¿¨"
   ClientHeight    =   7740
   ClientLeft      =   60
   ClientTop       =   405
   ClientWidth     =   11640
   BeginProperty Font 
      Name            =   "Microsoft YaHei UI Light"
      Size            =   10.5
      Charset         =   134
      Weight          =   290
      Underline       =   0   'False
      Italic          =   0   'False
      Strikethrough   =   0   'False
   EndProperty
   Icon            =   "frmBrowse.frx":0000
   LinkTopic       =   "Òþ²ØµÄÎÞµÐÐÇ - ä¯ÀÀ¹Ø¿¨"
   ScaleHeight     =   7740
   ScaleWidth      =   11640
   StartUpPosition =   3  '´°¿ÚÈ±Ê¡
   Begin VB.CommandButton cmdDownloadNinji 
      Caption         =   "ÏÂÔØ!"
      BeginProperty Font 
         Name            =   "Î¢ÈíÑÅºÚ Light"
         Size            =   10.5
         Charset         =   134
         Weight          =   290
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   495
      Left            =   8400
      TabIndex        =   12
      Tag             =   "TL"
      Top             =   7080
      Width           =   1455
   End
   Begin VB.CommandButton cmdRandomWorld 
      Caption         =   "Ëæ»úÊÀ½ç"
      BeginProperty Font 
         Name            =   "Î¢ÈíÑÅºÚ Light"
         Size            =   9
         Charset         =   134
         Weight          =   290
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Left            =   3120
      TabIndex        =   11
      Top             =   7080
      Width           =   855
   End
   Begin VB.CommandButton cmdCopyID 
      Caption         =   "¸´ÖÆ"
      BeginProperty Font 
         Name            =   "Î¢ÈíÑÅºÚ Light"
         Size            =   9
         Charset         =   134
         Weight          =   290
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   495
      Left            =   9960
      TabIndex        =   10
      Tag             =   "TL"
      Top             =   7080
      Width           =   735
   End
   Begin VB.TextBox txtPlayer 
      BeginProperty Font 
         Name            =   "Microsoft YaHei UI Light"
         Size            =   9
         Charset         =   134
         Weight          =   290
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Left            =   240
      Locked          =   -1  'True
      TabIndex        =   9
      Tag             =   "T"
      Text            =   "Íæ¼ÒËÑË÷"
      Top             =   7080
      Width           =   3735
   End
   Begin VB.CommandButton cmdMakerInfo 
      Caption         =   "×÷Õß"
      BeginProperty Font 
         Name            =   "Î¢ÈíÑÅºÚ Light"
         Size            =   9
         Charset         =   134
         Weight          =   290
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   495
      Left            =   10800
      TabIndex        =   8
      Tag             =   "TL"
      Top             =   7080
      Width           =   735
   End
   Begin VBCCR17.ComboBoxW cbCount 
      Height          =   375
      Left            =   2760
      TabIndex        =   7
      Tag             =   "T"
      Top             =   7080
      Width           =   1215
      _ExtentX        =   2143
      _ExtentY        =   661
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Microsoft YaHei UI Light"
         Size            =   9
         Charset         =   134
         Weight          =   290
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Text            =   "frmBrowse.frx":54AA
   End
   Begin VB.CheckBox chkPicture 
      BackColor       =   &H80000005&
      Caption         =   "ÏÔÊ¾Í¼Æ¬"
      Height          =   300
      Left            =   5160
      TabIndex        =   6
      Tag             =   "T"
      Top             =   7110
      Width           =   1215
   End
   Begin VB.CommandButton cmdDownload 
      Caption         =   "ÏÂÔØ!"
      BeginProperty Font 
         Name            =   "Î¢ÈíÑÅºÚ Light"
         Size            =   10.5
         Charset         =   134
         Weight          =   290
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   495
      Left            =   8400
      TabIndex        =   5
      Tag             =   "TL"
      Top             =   7080
      Width           =   1455
   End
   Begin VB.CommandButton cmdRefresh 
      Caption         =   "Ë¢ÐÂ"
      BeginProperty Font 
         Name            =   "Microsoft YaHei UI Light"
         Size            =   9
         Charset         =   134
         Weight          =   290
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Left            =   4080
      TabIndex        =   3
      Tag             =   "T"
      Top             =   7080
      Width           =   975
   End
   Begin VBCCR17.ComboBoxW cbDiff 
      Height          =   375
      Left            =   240
      TabIndex        =   2
      Tag             =   "T"
      Top             =   7080
      Width           =   2415
      _ExtentX        =   4260
      _ExtentY        =   661
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Microsoft YaHei UI Light"
         Size            =   9
         Charset         =   134
         Weight          =   290
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Text            =   "frmBrowse.frx":54CC
      ExtendedUI      =   -1  'True
   End
   Begin VBCCR17.ListView lst 
      Height          =   6375
      Left            =   240
      TabIndex        =   1
      Tag             =   "HW"
      Top             =   600
      Width           =   7935
      _ExtentX        =   13996
      _ExtentY        =   11245
      SmallIcons      =   "imgLstIcons"
      View            =   3
      FullRowSelect   =   -1  'True
      GridLines       =   -1  'True
      LabelEdit       =   1
      AutoSelectFirstItem=   0   'False
   End
   Begin VBCCR17.TabStrip TabStrip1 
      Height          =   7455
      Left            =   120
      TabIndex        =   0
      Tag             =   "HW"
      Top             =   120
      Width           =   8175
      _ExtentX        =   14420
      _ExtentY        =   13150
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Î¢ÈíÑÅºÚ Light"
         Size            =   10.5
         Charset         =   134
         Weight          =   290
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      BackColor       =   -2147483643
      InitTabs        =   "frmBrowse.frx":54F8
   End
   Begin VB6ResizerLib2.VB6Resizer VB6Resizer1 
      Left            =   720
      Top             =   7080
      _ExtentX        =   529
      _ExtentY        =   529
   End
   Begin VBCCR17.ImageList imgLstIcons 
      Left            =   8400
      Top             =   120
      _ExtentX        =   1005
      _ExtentY        =   1005
      ImageWidth      =   16
      ImageHeight     =   16
      UseBackColor    =   -1  'True
      InitListImages  =   "frmBrowse.frx":5BEC
   End
   Begin VB.Label lblCourse 
      BackStyle       =   0  'Transparent
      Caption         =   "Ñ¡Ôñ¹Ø¿¨ÒÔ²é¿´Ï¸½Ú"
      BeginProperty Font 
         Name            =   "Î¢ÈíÑÅºÚ Light"
         Size            =   10.5
         Charset         =   134
         Weight          =   290
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   4455
      Left            =   8400
      TabIndex        =   4
      Tag             =   "LH"
      Top             =   2520
      Width           =   3135
   End
   Begin VB.Image imgCourse 
      BorderStyle     =   1  'Fixed Single
      Height          =   1935
      Left            =   8400
      Stretch         =   -1  'True
      Tag             =   "L"
      ToolTipText     =   "µã»÷²é¿´´óÍ¼"
      Top             =   600
      Width           =   3135
   End
End
Attribute VB_Name = "frmBrowse"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit
Public Difficulty As New Dictionary, DifficultyEx As Variant, oJson As Object, LoadCompleted As Boolean, PreviousTab As Integer
Attribute DifficultyEx.VB_VarUserMemId = 1073938432
Attribute oJson.VB_VarUserMemId = 1073938432
Attribute LoadCompleted.VB_VarUserMemId = 1073938432
Attribute PreviousTab.VB_VarUserMemId = 1073938432

Private Sub cbCount_Click()
    WriteIni "HiddenSuperStar", "CountPerPage", cbCount.text, App.Path & "\Config.ini"
End Sub

Private Sub chkPicture_Click()
    Select Case chkPicture.Value
    Case 1
        ShowPicture = True
        imgCourse.Visible = True
        lblCourse.Height = 4335
        lblCourse.Top = 2640
        WriteIni "HiddenSuperStar", "ShowPicture", "True", App.Path & "\Config.ini"
    Case 0
        ShowPicture = False
        imgCourse.Visible = False
        lblCourse.Height = 6495
        lblCourse.Top = 480
        WriteIni "HiddenSuperStar", "ShowPicture", "False", App.Path & "\Config.ini"
    End Select
End Sub

Private Sub cmdCopyID_Click()
    Clipboard.SetText PrettyID(lst.SelectedItem.Tag)
    MsgBox PrettyID(lst.SelectedItem.Tag) & " ¸´ÖÆ³É¹¦!"
End Sub

'ÏÂÔØ¹Ø¿¨
'FOLDED: Private Sub cmdDownload_Click ()

'ÏÂÔØ¹þ¿â¹Ø¿¨
'FOLDED: Private Sub cmdDownloadNinji_Click ()

Private Sub cmdMakerInfo_Click()
    Dim Course As Variant
    If frmBrowse.lst.SelectedItem.SubItems(2) = "ÇëÄÍÐÄµÈ´ý" Then Exit Sub
    For Each Course In oJson("courses")
        If Course("course_id") = lst.SelectedItem.Tag Then
            frmPlayer.PlayerInfo Course("uploader")
            Exit For
        End If
    Next Course
End Sub

Private Sub Form_Load()
    On Error Resume Next
    LoadCompleted = False
    Me.Caption = "Òþ²Ø¤ÎÎÞµÐÐÇ " & App.Major & "." & App.Minor & "." & App.Revision & " - ÔÚÏß¹Ø¿¨"
    lst.ZOrder
    cbDiff.Clear
    cbDiff.AddItem "¼òµ¥", 0
    cbDiff.AddItem "ÆÕÍ¨", 1
    cbDiff.AddItem "À§ÄÑ", 2
    cbDiff.AddItem "¼«ÄÑ", 3
    cbDiff.text = "ÆÕÍ¨"
    cbCount.Clear
    cbCount.AddItem "10"
    cbCount.AddItem "15"
    cbCount.AddItem "20"
    cbCount.AddItem "25"
    cbCount.AddItem "30"
    cbCount.AddItem "40"
    cbCount.AddItem "50"
    cbCount.AddItem "60"
    cbCount.AddItem "80"
    cbCount.AddItem "100"
    CountPerPage = GetIni("HiddenSuperStar", "CountPerPage", App.Path & "\Config.ini")
    cbCount.text = CountPerPage
    Difficulty.Add "¼òµ¥", "e"
    Difficulty.Add "ÆÕÍ¨", "n"
    Difficulty.Add "À§ÄÑ", "ex"
    Difficulty.Add "¼«ÄÑ", "sex"
    ReDim DifficultyEx(0 To 4)
    DifficultyEx(0) = "¼òµ¥"
    DifficultyEx(1) = "ÆÕÍ¨"
    DifficultyEx(2) = "À§ÄÑ"
    DifficultyEx(3) = "¼«ÄÑ"
    chkPicture.ZOrder
    LoadCompleted = True
    Select Case GetIni("HiddenSuperStar", "ShowPicture", App.Path & "\Config.ini")
    Case "True"
        chkPicture.Value = 1
        ShowPicture = True
        imgCourse.Visible = True
        lblCourse.Height = 4335
        lblCourse.Top = 2640
    Case "False"
        chkPicture.Value = 0
        ShowPicture = False
        imgCourse.Visible = False
        lblCourse.Height = 6495
        lblCourse.Top = 480
    End Select
    frmBrowse.Show
    DoEvents
    LoadEndless
End Sub

Private Sub imgCourse_Click()
    Shell "cmd /c start " & Chr(34) & Chr(34) & " " & Chr(34) & "https://tgrcode.com/mm2/level_entire_thumbnail/" & lst.SelectedItem.Tag & Chr(34)
End Sub


Private Sub lst_Click()
    On Error GoTo ErrHandler
    Dim Course As Variant
    '¼ÓÔØ¹Ø¿¨Ï¸½Ú
    '»ñÈ¡Õâ¸ö¹Ø¿¨
    If TabStrip1.SelectedItem.Key = "ninji" Then
    Debug.Print "Ninji Mode!"
        For Each Course In oJson("courses")
            If CStr(Course("data_id")) = CStr(lst.SelectedItem.Tag) Then
                lblCourse = Course("name") & vbCrLf _
                          & Course("game_style_name") & " " & ConvertLevelTheme(CStr(Course("theme_name"))) & vbCrLf _
                          & "¿ªÊ¼: " & Course("uploaded") & vbCrLf _
                          & "½áÊø: " & Course("end_time") & vbCrLf _
                          & "¼ò½é: " & Replace(Course("description"), "\n", "")
                Exit For
            End If
        Next Course
        DoEvents
    Else
        For Each Course In oJson("courses")
            If Course("course_id") = lst.SelectedItem.Tag Then
                lblCourse = Course("name") & vbCrLf _
                          & "ID: " & PrettyID(lst.SelectedItem.Tag) & vbCrLf _
                          & Course("game_style_name") & " " & ConvertLevelTheme(CStr(Course("theme_name"))) & vbCrLf _
                          & Course("uploaded_pretty") & vbCrLf _
                          & DifficultyEx(Course("difficulty")) & "  " & Course("clear_rate") & vbCrLf _
                          & Course("likes") & "ÔÞ, " & Course("boos") & "Ø«" & vbCrLf _
                          & "±êÇ©:" & PrettyTag(CInt(Course("tags")(1))) & ", " & PrettyTag(CInt(Course("tags")(2))) & vbCrLf _
                          & "¼ò½é: " & Replace(Course("description"), "\n", "")
                Exit For
            End If
        Next Course
        DoEvents
        If ShowPicture Then
            imgCourse.Picture = LoadPicture("https://tgrcode.com/mm2/level_thumbnail/" & lst.SelectedItem.Tag)
        End If
    End If
    Exit Sub
ErrHandler:
    Exit Sub
End Sub

'±êÇ©ÅÐ¶ÏÏà¹Ø£¬ÕÛÉÏÁË
'FOLDED: Private Sub TabStrip1_TabClick (ByVal TabItem As VBCCR17.TbsTab)
'FOLDED: Private Sub cmdRefresh_Click ()


'ÅÅÐÐ
'FOLDED: Private Sub LoadPopular ()

'Íæ¼Ò
'FOLDED: Private Sub LoadPlayer ()

'IDËÑË÷
'FOLDED: Private Sub LoadID ()

'×îÐÂ
'FOLDED: Private Sub LoadNew ()

'Ê×Ò³ Ëæ»ú
'FOLDED: Private Sub LoadEndless ()

'ÊÀ½çËÑË÷
'FOLDED: Private Sub LoadWorld ()

'¹þ¿â
'FOLDED: Private Sub LoadNinji ()

Private Sub VB6Resizer1_AfterResize()
    On Error Resume Next
    If ShowPicture Then lblCourse.Top = 2640
    If LoadCompleted Then lst.ColumnHeaders(3).Width = 5500 + (frmBrowse.Width - 11760)
End Sub


























'ÒÑ¾­ÕÛµþµÄ´úÂë:
Private Sub cmdDownload_Click()
    If lst.SelectedItem.SubItems(2) = "ÇëÄÍÐÄµÈ´ý" Then Exit Sub
    Select Case MsgBox("Õâ½«»áÓÃ " & lst.SelectedItem.SubItems(2) & " ¸²¸Ç " & frmMain.lstLocal.SelectedItem.SubItems(2) & " £¬" & vbCrLf & "È·¶¨ÏÂÔØÕâ¸ö¹Ø¿¨Âð£¿", vbYesNo, "ÏÂÔØ¹Ø¿¨")
    Case vbYes
        frmDummy.DownloadWindow
        DoEvents
        Call URLDownloadToFile(0, "https://tgrcode.com/mm2/level_data/" & lst.SelectedItem.Tag, SavePath & "\" & frmMain.lstLocal.SelectedItem.Tag & "_progress", 0, 0)
        If CheckFileExists(SavePath & "\" & frmMain.lstLocal.SelectedItem.Tag & "_progress") Then
            Kill SavePath & "\" & frmMain.lstLocal.SelectedItem.Tag
            Sleep 20
            Name SavePath & "\" & frmMain.lstLocal.SelectedItem.Tag & "_progress" As SavePath & "\" & frmMain.lstLocal.SelectedItem.Tag
            With New MD5Hash
                Kill Environ("Temp") & "\HSSTemp\" & LCase(.HashBytes(StrConv(SavePath & "\" & frmMain.lstLocal.SelectedItem.Tag, vbFromUnicode))) & ".json"
            End With
            frmDummy.Hide
            MsgBox "ÏÂÔØÍê³É£¡", vbInformation
            frmMain.LoadLocalLevels
        Else
            MsgBox "³öÏÖ´íÎó£¬Çë¼ì²éÄãµÄÍøÂçÁ¬½Ó¡£", vbCritical
            End
        End If
    Case vbNo
        Exit Sub
    End Select
End Sub
Private Sub cmdDownloadNinji_Click()
    If lst.SelectedItem.SubItems(2) = "ÇëÄÍÐÄµÈ´ý" Then Exit Sub
    Select Case MsgBox("Õâ½«»áÓÃ " & lst.SelectedItem.SubItems(2) & " ¸²¸Ç " & frmMain.lstLocal.SelectedItem.SubItems(2) & " £¬" & vbCrLf & "È·¶¨ÏÂÔØÕâ¸ö¹Ø¿¨Âð£¿", vbYesNo, "ÏÂÔØ¹Ø¿¨")
    Case vbYes
        frmDummy.DownloadWindow
        DoEvents
        Call URLDownloadToFile(0, "https://tgrcode.com/mm2/level_data_dataid/" & lst.SelectedItem.Tag, SavePath & "\" & frmMain.lstLocal.SelectedItem.Tag & "_progress", 0, 0)
        If CheckFileExists(SavePath & "\" & frmMain.lstLocal.SelectedItem.Tag & "_progress") Then
            Kill SavePath & "\" & frmMain.lstLocal.SelectedItem.Tag
            Sleep 20
            Name SavePath & "\" & frmMain.lstLocal.SelectedItem.Tag & "_progress" As SavePath & "\" & frmMain.lstLocal.SelectedItem.Tag
            With New MD5Hash
                Kill Environ("Temp") & "\HSSTemp\" & LCase(.HashBytes(StrConv(SavePath & "\" & frmMain.lstLocal.SelectedItem.Tag, vbFromUnicode))) & ".json"
            End With
            frmDummy.Hide
            MsgBox "ÏÂÔØÍê³É£¡", vbInformation
            frmMain.LoadLocalLevels
        Else
            MsgBox "³öÏÖ´íÎó£¬Çë¼ì²éÄãµÄÍøÂçÁ¬½Ó¡£", vbCritical
            End
        End If
    Case vbNo
        Exit Sub
    End Select
End Sub
Private Sub LoadNinji()
    Dim Course As Variant, CC As Integer
    '½çÃæ
    Me.MousePointer = 11
    cbDiff.Visible = False
    txtPlayer.Visible = False
    cmdDownloadNinji.Visible = True
    cmdDownload.Visible = False
    cmdRandomWorld.Visible = False
    cmdRefresh.Visible = True
    cmdRefresh.Caption = "Ë¢ÐÂ"
    cbCount.Visible = False
    chkPicture.Visible = True
    cmdMakerInfo.Visible = False
    cmdCopyID.Visible = False
    lst.ColumnHeaders.Clear
    lst.ColumnHeaders.Add 1, "Icon", "", 400
    lst.ColumnHeaders.Add 2, "GameStyle", "°æ±¾", 1000
    lst.ColumnHeaders.Add 3, "CourseName", "¹Ø¿¨", 6000
    'With lst
    '.BorderStyle = 3
    '.Height = 6375    '6855
    '.Left = 240
    '.Top = 600
    '.Width = 7935
    'End With
    DoEvents
    '»ñÈ¡
    lst.ListItems.Clear
    DoEvents
    lst.ListItems.Add , , " ", 0
    lst.ListItems(1).SubItems(1) = "¼ÓÔØÖÐ ..."
    lst.ListItems(1).SubItems(2) = "ÇëÄÍÐÄµÈ´ý"
    DoEvents
    Set oJson = JSON.parse(xhrGet("https://tgrcode.com/mm2/ninji_info"))
    lst.ListItems.Clear
    For Each Course In oJson("courses")
        CC = lst.ListItems.Count + 1
        DoEvents
        lst.ListItems.Add , , "", , Course("game_style_name")
        lst.ListItems(CC).SubItems(1) = Course("game_style_name")
        lst.ListItems(CC).SubItems(2) = Course("name")
        With lst.ListItems(CC)
            .ToolTipText = Course("name")
            .Tag = CStr(Course("data_id"))
            Debug.Print .Tag
        End With
    Next Course
    Me.MousePointer = 0
End Sub
Private Sub LoadPopular()
    Dim Course As Variant, CC As Integer
    '½çÃæ
    Me.MousePointer = 11
    cbDiff.Visible = True
    cmdRandomWorld.Visible = False
    txtPlayer.Visible = False
    cmdRefresh.Visible = True
    cmdDownload.Visible = True
    cmdDownloadNinji.Visible = False
    cmdRefresh.Caption = "Ë¢ÐÂ"
    cbCount.Visible = True
    chkPicture.Visible = True
    cmdMakerInfo.Visible = True
    cmdCopyID.Visible = True
    lst.ColumnHeaders.Clear
    lst.ColumnHeaders.Add 1, "Icon", "", 400
    lst.ColumnHeaders.Add 2, "GameStyle", "°æ±¾", 1000
    lst.ColumnHeaders.Add 3, "CourseName", "¹Ø¿¨", 6000
    'With lst
    '.BorderStyle = 3
    '.Height = 6375    '6855
    '.Left = 240
    '.Top = 600
    '.Width = 7935
    'End With
    DoEvents
    '»ñÈ¡
    lst.ListItems.Clear
    DoEvents
    lst.ListItems.Add , , " ", 0
    lst.ListItems(1).SubItems(1) = "¼ÓÔØÖÐ ..."
    lst.ListItems(1).SubItems(2) = "ÇëÄÍÐÄµÈ´ý"
    DoEvents
    Set oJson = JSON.parse(xhrGet("https://tgrcode.com/mm2/search_popular?count=" & CountPerPage & "&difficulty=" & Difficulty(cbDiff.text) & "&rejectRegions="))
    lst.ListItems.Clear
    For Each Course In oJson("courses")
        CC = lst.ListItems.Count + 1
        DoEvents
        lst.ListItems.Add , , "", , Course("game_style_name")
        lst.ListItems(CC).SubItems(1) = Course("game_style_name")
        lst.ListItems(CC).SubItems(2) = Course("name")
        With lst.ListItems(CC)
            .ToolTipText = Course("name")
            .Tag = Course("course_id")
        End With
    Next Course
    Me.MousePointer = 0
End Sub
Private Sub LoadPlayer()
    Dim Course As Variant, CC As Integer, PlayerID As String, RetVal As String
    '½çÃæ
    Me.MousePointer = 11
    cbDiff.Visible = False
    cmdRandomWorld.Visible = False
    cmdDownloadNinji.Visible = False
    cmdDownload.Visible = True
    cmdRefresh.Visible = True
    txtPlayer.Visible = True
    cmdRefresh.Caption = "ÔÙ´ÎËÑË÷"
    cbCount.Visible = False
    chkPicture.Visible = True
    cmdMakerInfo.Visible = True
    cmdCopyID.Visible = True
    lst.ColumnHeaders.Clear
    lst.ColumnHeaders.Add 1, "Icon", "", 400
    lst.ColumnHeaders.Add 2, "GameStyle", "°æ±¾", 1000
    lst.ColumnHeaders.Add 3, "CourseName", "¹Ø¿¨", 6000
    'With lst
    '.BorderStyle = 3
    '.Height = 6375    '6855
    '.Left = 240
    '.Top = 600
    '.Width = 7935
    'End With
    DoEvents
    'ËÑË÷
    PlayerID = Replace(Replace(InputBox("ÇëÊäÈëÍæ¼ÒID£¬´ø²»´øºá¸Ü¾ù¿É£º", "ËÑË÷"), "-", ""), " ", "")
    If Len(PlayerID) <> 9 Then MsgBox "ÇëÊäÈëÕýÈ·µÄÍæ¼ÒID", vbCritical: frmBrowse.MousePointer = 0: Exit Sub
    '»ñÈ¡
    lst.ListItems.Clear
    DoEvents
    lst.ListItems.Add , , " ", 0
    lst.ListItems(1).SubItems(1) = "¼ÓÔØÖÐ ..."
    lst.ListItems(1).SubItems(2) = "ÇëÄÍÐÄµÈ´ý"
    DoEvents
    RetVal = xhrGet("https://tgrcode.com/mm2/get_posted/" & PlayerID)
    If RetVal = "Error" Then Exit Sub
    Set oJson = JSON.parse(RetVal)
    lst.ListItems.Clear
    For Each Course In oJson("courses")
        CC = lst.ListItems.Count + 1
        DoEvents
        lst.ListItems.Add , , "", , Course("game_style_name")
        lst.ListItems(CC).SubItems(1) = Course("game_style_name")
        lst.ListItems(CC).SubItems(2) = Course("name")
        With lst.ListItems(CC)
            .ToolTipText = Course("name")
            .Tag = Course("course_id")
        End With
    Next Course
    txtPlayer.text = oJson("courses")(1)("uploader")("name") & " " & PrettyID(PlayerID)
    txtPlayer.ZOrder
    Me.MousePointer = 0
End Sub
Private Sub LoadID()
    Dim Course As Object, CC As Integer, CourseID As String, RetVal As String
    '½çÃæ
    Me.MousePointer = 11
    cbDiff.Visible = False
    cmdDownloadNinji.Visible = False
    cmdRefresh.Visible = True
    txtPlayer.Visible = False
    cmdDownload.Visible = True
    cmdRandomWorld.Visible = False
    cmdMakerInfo.Visible = True
    cmdCopyID.Visible = True
    cmdRefresh.Caption = "ÔÙ´ÎËÑË÷"
    cbCount.Visible = False
    chkPicture.Visible = True
    lst.ColumnHeaders.Clear
    lst.ColumnHeaders.Add 1, "Icon", "", 400
    lst.ColumnHeaders.Add 2, "GameStyle", "°æ±¾", 1000
    lst.ColumnHeaders.Add 3, "CourseName", "¹Ø¿¨", 6000
    'With lst
    '.BorderStyle = 3
    '.Height = 6375    '6855
    '.Left = 240
    '.Top = 600
    '.Width = 7935
    'End With
    DoEvents
    lst.ListItems.Clear
    DoEvents
    'ËÑË÷
    CourseID = Replace(Replace(InputBox("ÇëÊäÈë¹Ø¿¨ID£¬´ø²»´øºá¸Ü¾ù¿É£º", "ËÑË÷"), "-", ""), " ", "")
    If Len(CourseID) <> 9 Then MsgBox "ÇëÊäÈëÕýÈ·µÄ¹Ø¿¨ID", vbCritical: frmBrowse.MousePointer = 0: Exit Sub
    '»ñÈ¡
    lst.ListItems.Add , , " ", 0
    lst.ListItems(1).SubItems(1) = "¼ÓÔØÖÐ ..."
    lst.ListItems(1).SubItems(2) = "ÇëÄÍÐÄµÈ´ý"
    DoEvents
    RetVal = xhrGet("https://tgrcode.com/mm2/level_info/" & CourseID)
    If RetVal = "Error" Then Exit Sub
    Set oJson = JSON.parse("{" & Chr(34) & "courses" & Chr(34) & ":[" & RetVal & "]}")
    Set Course = oJson("courses")(1)
    lst.ListItems.Clear
    DoEvents
    lst.ListItems.Add , , "", , Course("game_style_name")
    lst.ListItems(1).SubItems(1) = Course("game_style_name")
    lst.ListItems(1).SubItems(2) = Course("name")
    With lst.ListItems(1)
        .ToolTipText = Course("name")
        .Tag = Course("course_id")
    End With
    Me.MousePointer = 0
End Sub
Private Sub LoadNew()
    Dim Course As Variant, CC As Integer
    '½çÃæ
    Me.MousePointer = 11
    cbDiff.Visible = False
    txtPlayer.Visible = False
    cmdDownloadNinji.Visible = False
    cmdDownload.Visible = True
    cmdRandomWorld.Visible = False
    cmdRefresh.Visible = True
    cmdRefresh.Caption = "Ë¢ÐÂ"
    cbCount.Visible = True
    chkPicture.Visible = True
    cmdMakerInfo.Visible = True
    cmdCopyID.Visible = True
    lst.ColumnHeaders.Clear
    lst.ColumnHeaders.Add 1, "Icon", "", 400
    lst.ColumnHeaders.Add 2, "GameStyle", "°æ±¾", 1000
    lst.ColumnHeaders.Add 3, "CourseName", "¹Ø¿¨", 6000
    'With lst
    '.BorderStyle = 3
    '.Height = 6375    '6855
    '.Left = 240
    '.Top = 600
    '.Width = 7935
    'End With
    DoEvents
    '»ñÈ¡
    lst.ListItems.Clear
    DoEvents
    lst.ListItems.Add , , " ", 0
    lst.ListItems(1).SubItems(1) = "¼ÓÔØÖÐ ..."
    lst.ListItems(1).SubItems(2) = "ÇëÄÍÐÄµÈ´ý"
    DoEvents
    Set oJson = JSON.parse(xhrGet("https://tgrcode.com/mm2/search_new?count=" & CountPerPage))
    lst.ListItems.Clear
    For Each Course In oJson("courses")
        CC = lst.ListItems.Count + 1
        DoEvents
        lst.ListItems.Add , , "", , Course("game_style_name")
        lst.ListItems(CC).SubItems(1) = Course("game_style_name")
        lst.ListItems(CC).SubItems(2) = Course("name")
        With lst.ListItems(CC)
            .ToolTipText = Course("name")
            .Tag = Course("course_id")
        End With
    Next Course
    Me.MousePointer = 0
End Sub
Private Sub LoadEndless()
    Dim Course As Variant, CC As Integer
    '½çÃæ
    Me.MousePointer = 11
    cbDiff.Visible = True
    cmdRandomWorld.Visible = False
    txtPlayer.Visible = False
    cmdDownloadNinji.Visible = False
    cmdRefresh.Visible = True
    cmdDownload.Visible = True
    cmdRefresh.Caption = "Ë¢ÐÂ"
    cbCount.Visible = True
    chkPicture.Visible = True
    cmdMakerInfo.Visible = True
    cmdCopyID.Visible = True
    lst.ColumnHeaders.Clear
    lst.ColumnHeaders.Add 1, "Icon", "", 400
    lst.ColumnHeaders.Add 2, "GameStyle", "°æ±¾", 1000
    lst.ColumnHeaders.Add 3, "CourseName", "¹Ø¿¨", 6000
    'With lst
    '.BorderStyle = 3
    '.Height = 6375    '6855
    '.Left = 240
    '.Top = 600
    '.Width = 7935
    'End With
    DoEvents
    '»ñÈ¡
    lst.ListItems.Clear
    DoEvents
    lst.ListItems.Add , , " ", 0
    lst.ListItems(1).SubItems(1) = "¼ÓÔØÖÐ ..."
    lst.ListItems(1).SubItems(2) = "ÇëÄÍÐÄµÈ´ý"
    DoEvents
    Set oJson = JSON.parse(xhrGet("https://tgrcode.com/mm2/search_endless_mode?count=" & CountPerPage & "&difficulty=" & Difficulty(cbDiff.text)))
    lst.ListItems.Clear
    For Each Course In oJson("courses")
        CC = lst.ListItems.Count + 1
        DoEvents
        lst.ListItems.Add , , "", , Course("game_style_name")
        lst.ListItems(CC).SubItems(1) = Course("game_style_name")
        lst.ListItems(CC).SubItems(2) = Course("name")
        With lst.ListItems(CC)
            .ToolTipText = Course("name")
            .Tag = Course("course_id")
        End With
    Next Course
    Me.MousePointer = 0
End Sub
Private Sub LoadWorld()
    Dim Course As Variant, CC As Integer, WorldID As String, RetVal As String
    '½çÃæ
    Me.MousePointer = 11
    cbDiff.Visible = False
    cmdDownloadNinji.Visible = False
    cmdDownload.Visible = True
    cmdRandomWorld.Visible = True
    cmdRefresh.Visible = True
    txtPlayer.Visible = True
    cmdRefresh.Caption = "ÔÙ´ÎËÑË÷"
    cbCount.Visible = False
    chkPicture.Visible = True
    cmdMakerInfo.Visible = True
    cmdCopyID.Visible = True
    lst.ColumnHeaders.Clear
    lst.ColumnHeaders.Add 1, "Icon", "", 400
    lst.ColumnHeaders.Add 2, "GameStyle", "°æ±¾", 1000
    lst.ColumnHeaders.Add 3, "CourseName", "¹Ø¿¨", 6000
    'With lst
    '.BorderStyle = 3
    '.Height = 6375    '6855
    '.Left = 240
    '.Top = 600
    '.Width = 7935
    'End With
    DoEvents
    'ËÑË÷
    WorldID = ""
    WorldID = InputBox("ÇëÊäÈëÊÀ½çID¡£" & vbCrLf & "ÊÀ½çID²»ÊÇÍæ¼ÒID£¬Èç¹ûÄãÏëÓÎÍæÄ³¸öÍæ¼ÒµÄÊÀ½ç£¬¾ÍÈ¥Íæ¼ÒËÑË÷ÀïÏÈÈ¥»ñÈ¡ÊÀ½çID¡£", "ËÑË÷")
    If WorldID = "" Then Me.MousePointer = 0: Exit Sub
    '»ñÈ¡
    lst.ListItems.Clear
    DoEvents
    lst.ListItems.Add , , " ", 0
    lst.ListItems(1).SubItems(1) = "¼ÓÔØÖÐ ..."
    lst.ListItems(1).SubItems(2) = "ÇëÄÍÐÄµÈ´ý"
    DoEvents
    RetVal = xhrGet("https://tgrcode.com/mm2/super_world/" & WorldID)
    If RetVal = "Error" Then Exit Sub
    Set oJson = JSON.parse(RetVal)
    lst.ListItems.Clear
    For Each Course In oJson("courses")
        CC = lst.ListItems.Count + 1
        DoEvents
        lst.ListItems.Add , , "", , Course("game_style_name")
        lst.ListItems(CC).SubItems(1) = Course("game_style_name")
        lst.ListItems(CC).SubItems(2) = Course("name")
        With lst.ListItems(CC)
            .ToolTipText = Course("name")
            .Tag = Course("course_id")
        End With
    Next Course
    txtPlayer.text = "Super " & oJson("courses")(1)("uploader")("name") & " World " & WorldID
    txtPlayer.ZOrder
    Me.MousePointer = 0
End Sub
Private Sub cmdRefresh_Click()
'Ë¢ÐÂ
    Select Case TabStrip1.SelectedItem.Key
    Case "popular"
        LoadPopular
    Case "new"
        LoadNew
    Case "endless"
        LoadEndless
    Case "id"
        LoadID
    Case "player"
        LoadPlayer
    Case "world"
        LoadWorld
    Case "ninji"
        LoadNinji
    End Select
End Sub
Private Sub TabStrip1_TabClick(ByVal TabItem As VBCCR17.TbsTab)
    PreviousTab = TabItem.Index
    Select Case TabItem.Key
    Case "popular"
        LoadPopular
    Case "new"
        LoadNew
    Case "endless"
        LoadEndless
    Case "id"
        LoadID
    Case "player"
        LoadPlayer
    Case "world"
        LoadWorld
    Case "ninji"
        LoadNinji
    End Select
End Sub
'ÕÛµþÇøÓòÔÚ´Ë½áÊø:






